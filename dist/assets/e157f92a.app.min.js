define("multiSceneMovie/app",["multiSceneMovie/movie","multiSceneMovie/stage","multiSceneMovie/scene","multiSceneMovie/eventEmitter","exports"],function(a,b,c,d,e){"use strict";var f,g=a["default"],h=b["default"],i=c["default"],j=d["default"];f=function(){function a(a){this.rootElementId=a,this.createAndComposeScenes()}var b;return a.prototype.startScenes=function(){return this.scenes[0].start()},a.prototype.bindEvent=function(a,b){var c;return c=new j,c.listen(a,b)},b=function(a,b,c,d,e){var f,g;return f=new j,g=b.stage,g.movie=a,a.movieDidLoad=function(){return f.emit("movie:loaded")},a.movieDidStart=function(){return f.emit("movie:started")},a.movieDidPause=function(){return f.emit("movie:paused")},a.movieDidResume=function(){return f.emit("movie:resumed")},a.movieDidFinish=function(){return f.emit("movie:finished")},a.movieDidPlayedTo=function(a){return f.emit("movie:played:"+a)},g.appearanceDetector.didAppear=function(){return f.emit("movie:screen:appeared")},g.appearanceDetector.didDisappear=function(){return f.emit("movie:screen:disappeared")},f.listen("movie:loaded",c.finish),f.listen("movie:finished",b.finish),f.listen("movie:finished",d.start),f.listen("movie:screen:appeared",function(){return g.isOpen()?a.play():void 0}),f.listen("movie:screen:disappeared",function(){return a.pause()}),c.sceneDidStart=a.loadMovie,c.sceneDidFinish=b.start,b.sceneDidStart=function(){return a.rewind(),g.detectAppearance()?a.play():void 0},b.sceneDidFinish=e.start,document.addEventListener("scroll",g.detectAppearance.bind(g),!1),d.stage.element.addEventListener("click",function(){return e.stage.close(),d.finish(),b.start()},!1)},a.prototype.createAndComposeScenes=function(){var a,c,d,e,f,k,l,m,n,o,p,q,r,s;return(p=document.getElementById(this.rootElementId))?(new j(p),r=p.dataset,m=document.getElementById(r.loadingStage),k=document.getElementById(r.finishedStage),a=document.getElementById(r.contentStage),f=document.getElementById(p.dataset.movieStage).dataset,q=document.getElementById(f.screen),s=document.getElementById(f.strips).getElementsByClassName(f.stripsClass),e=g.createFromHTMLElement(q,s),d=function(a){return new i(new h(a))},o=d(q),n=d(m),l=d(k),c=d(a),b(e,o,n,l,c),this.scenes=[n,o,l,c]):void 0},a}(),e["default"]=f}),define("multiSceneMovie/appearanceDetector",["exports"],function(a){"use strict";var b;b=function(){function a(a){this.element=a,this.wasVisible=!1,this.detect()}return a.prototype.viewportHeight=function(){return window.innerHeight},a.prototype.viewportTop=function(){return window.scrollY},a.prototype.viewportBottom=function(){return this.viewportTop()+this.viewportHeight()},a.prototype.elementTop=function(){return this.element.getBoundingClientRect().top},a.prototype.elementBottom=function(){return this.elementTop()+this.element.getBoundingClientRect().height},a.prototype.topVisible=function(){return this.elementTop()>0&&this.elementTop()<this.viewportBottom()},a.prototype.bottomVisible=function(){return this.elementBottom()>0&&this.elementBottom()<this.viewportBottom()},a.prototype.visible=function(){return this.topVisible()&&this.bottomVisible()},a.prototype.didAppear=function(){},a.prototype.didDisappear=function(){},a.prototype.detect=function(){var a;return a=this.visible(),a?this.wasVisible||this.didAppear():this.wasVisible&&this.didDisappear(),this.wasVisible=a},a}(),a["default"]=b}),define("multiSceneMovie/eventEmitter",["exports"],function(a){"use strict";var b;b=function(){function a(b){if("object"==typeof a.instance)return a.instance;if(!b)throw"please set root element for event emitting";this.element=b,a.instance=this}return a.prototype.emit=function(a,b){return this.element.dispatchEvent("object"==typeof b?new CustomEvent(a,b):new Event(a))},a.prototype.listen=function(a,b){return this.element.addEventListener(a,b,!1)},a}(),a["default"]=b}),define("multiSceneMovie/frameRectangle",["exports"],function(a){"use strict";var b;b=function(){function a(a,b){this.leftPosition=a,this.topPosition=b}return a.prototype.backgroundPositionText=function(){return""+this.leftPosition+"px "+this.topPosition+"px"},a}(),a["default"]=b}),define("multiSceneMovie/movie",["multiSceneMovie/screen","multiSceneMovie/strip","exports"],function(a,b,c){"use strict";var d,e=a["default"],f=b["default"],g=function(a,b){return function(){return a.apply(b,arguments)}};d=function(){function a(a,b,c){this.screen=a,this.strips=b,this.fps=c,this.loadMovie=g(this.loadMovie,this),this.screen.setStrips(this.strips),this._loaded=0,this.currentFrameIndex=0,this.currentTimeCodeInSeconds=0,this.currentTimeCodeInSecondsWas=0}return a.prototype.loadMovie=function(){var a,b,c,d,e,f;for(e=this.strips,f=[],c=0,d=e.length;d>c;c++)b=e[c],a=new Image,a.onload=function(a){return function(){return a._loaded+=1,a._loaded===a.strips.length?a.movieDidLoad():void 0}}(this),f.push(a.src=b.image_uri);return f},a.prototype.moveFrameIndex=function(){return this.currentFrameIndex++,this.currentTimeCodeInSecondsWas=this.currentTimeCodeInSeconds,this.currentTimeCodeInSeconds=Math.floor(this.currentFrameIndex/this.fps),this.currentTimeCodeInSecondsWas!==this.currentTimeCodeInSeconds?this.movieDidPlayedTo(this.currentTimeCodeInSeconds):void 0},a.prototype.play=function(){return this.timerId?void 0:(this.isAtFirstFrame()?this.movieDidStart():this.movieDidResume(),this.timerId=setInterval(function(a){return function(){return a.isAtLastFrame()&&(a.pause(),a.movieDidFinish()),a.screen.showCurrentFrame(),a.screen.moveFrameToNext(),a.moveFrameIndex()}}(this),1e3/this.fps))},a.prototype.pause=function(){return this.isAtLastFrame()||this.movieDidPause(),this.timerId&&clearInterval(this.timerId),this.timerId=void 0},a.prototype.rewind=function(){return this.screen.moveFrameToFirst(),this.currentFrameIndex=0,this.currentTimeCodeInSeconds=0,this.currentTimeCodeInSecondsWas=0},a.prototype.isAtFirstFrame=function(){return this.screen.isAtFirstFrame()},a.prototype.isAtLastFrame=function(){return this.screen.isAtLastFrame()},a.prototype.movieDidLoad=function(){},a.prototype.movieDidStart=function(){},a.prototype.movieDidResume=function(){},a.prototype.movieDidPause=function(){},a.prototype.movieDidFinish=function(){},a.prototype.movieDidPlayedTo=function(){},a.createFromHTMLElement=function(b,c){var d,g,h,i,j,k;for(d=b.dataset,g=new e(b),i=[],j=0,k=c.length;k>j;j++)h=c[j],i.push(new f(h.dataset.url,parseInt(d.frameWidth,10),parseInt(d.frameHeight,10),parseInt(h.dataset.framesCount,10)));return new a(g,i,parseInt(d.fps,10))},a}(),c["default"]=d}),define("multiSceneMovie/scene",["exports"],function(a){"use strict";var b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(a){this.stage=a,this.finish=c(this.finish,this),this.start=c(this.start,this)}return a.prototype.sceneDidStart=function(){},a.prototype.sceneDidFinish=function(){},a.prototype.start=function(){return this.stage.open(),this.sceneDidStart()},a.prototype.finish=function(){return this.stage.close(),this.sceneDidFinish()},a}(),a["default"]=b}),define("multiSceneMovie/screen",["exports"],function(a){"use strict";var b;b=function(){function a(a){this.element=a,this.setDefaultImage()}return a.prototype.setStrips=function(a){return this.strips=a,this.currentStipIndex=0},a.prototype.setDefaultImage=function(){var a;return this.defaultImageUrl()?(a=this.element.style.cssText,this.element.style.cssText=a+("background-image: url("+this.defaultImageUrl()+"); background-size: cover;　background-repeat: no-repeat;")):void 0},a.prototype.defaultImageUrl=function(){var a;return a=this.element.dataset.defaultImage,""===a?void 0:a},a.prototype.showCurrentFrame=function(){return"url("+this.currentStrip().image_uri+")"!==this.element.style.backgroundImage&&this.fitCssToCurrentStrip(),this.element.style.backgroundPosition=this.currentStrip().currentFrame().backgroundPositionText()},a.prototype.currentStrip=function(){return this.strips[this.currentStipIndex]},a.prototype.moveFrameToNext=function(){return this.currentStrip().isAtLastFrame()&&this.moveStripToNext(),this.currentStrip().moveFrameToNext()},a.prototype.moveStripToNext=function(){return this.currentStrip().frameIndex=0,this.currentStrip()!==this.strips[this.strips.length-1]?this.currentStipIndex++:void 0},a.prototype.fitCssToCurrentStrip=function(){var a;return a=this.element.style.cssText,this.element.style.cssText=a+("background-image: url("+this.currentStrip().image_uri+"); background-size: cover;　background-repeat: no-repeat;")},a.prototype.moveFrameToFirst=function(){return this.currentStipIndex=0,this.currentStrip().frameIndex=0,this.fitCssToCurrentStrip()},a.prototype.isAtFirstFrame=function(){return this.currentStrip()!==this.strips[0]?!1:0===this.currentStrip().frameIndex?!0:!1},a.prototype.isAtLastFrame=function(){return this.currentStrip()!==this.strips[this.strips.length-1]?!1:this.currentStrip().isAtLastFrame()?!0:!1},a}(),a["default"]=b}),define("multiSceneMovie/stage",["multiSceneMovie/appearanceDetector","exports"],function(a,b){"use strict";var c,d=a["default"];c=function(){function a(a){this.element=a,this.appearanceDetector=new d(this.element)}return a.prototype.stageDidAppear=function(){},a.prototype.stageDidDisapper=function(){},a.prototype.detectAppearance=function(){return this.appearanceDetector.detect()},a.prototype.open=function(){return this.element.classList.remove("hide")},a.prototype.close=function(){return this.element.classList.add("hide")},a.prototype.isOpen=function(){return!this.isClose()},a.prototype.isClose=function(){return this.element.classList.contains("hide")},a}(),b["default"]=c}),define("multiSceneMovie/strip",["multiSceneMovie/frameRectangle","exports"],function(a,b){"use strict";var c,d=a["default"];c=function(){function a(a,b,c,e){var f,g,h;for(this.image_uri=a,this.frameWidth=b,this.frameHeight=c,this.framesCount=e,this.frames=[],f=g=0,h=this.framesCount-1;h>=0?h>=g:g>=h;f=h>=0?++g:--g)this.frames.push(new d(0,this.frameHeight*(this.framesCount-f)));this.frameIndex=0}return a.prototype.currentFrame=function(){return this.frames[this.frameIndex]},a.prototype.moveFrameToNext=function(){return this.frameIndex++},a.prototype.isAtLastFrame=function(){return this.frameIndex===this.framesCount-1},a}(),b["default"]=c});